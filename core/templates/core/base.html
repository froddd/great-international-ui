{% extends 'directory_components/base.html' %}

{% load static from staticfiles %}
{% load i18n %}
{% get_current_language_bidi as LANGUAGE_BIDI %}
{% get_current_language as LANGUAGE %}

{% block head_title %}{{ international_home_link.label }}{% endblock %}

{% load static_absolute international_header from directory_components %}

{% block header_js %}{% endblock %}
{% block head_js %}{% endblock %}
{% block vendor_js %}
    <script src="{% static 'directory_components/js/vendor/details-polyfill.js' %}"></script>
{% endblock %}

{% block head_js_ga360 %}
    <script src="{% static 'core/js/dit.tagging-min.js' %}"></script>
    <script type="text/javascript">
        window.dataLayer = window.dataLayer || [];
        {% if ga360 and not skip_ga360 %}
            window.dataLayer.push({
                'businessUnit': '{{ ga360.business_unit }}',
                'siteSection': '{{ ga360.site_section}}',
                'siteSubsection': '{{ ga360.site_subsection }}',
                'siteLanguage': '{{ ga360.site_language }}',
                'userId': '{{ ga360.user_id }}',
                'loginStatus': '{{ ga360.login_status }}',
            });
            dit.tagging.base.init();
        {% endif %}
    </script>
{% endblock %}

{% block head_css %}
    {{ block.super }}
    <link rel="stylesheet" href="{% static 'core/styles/main.css' %}">
{% endblock %}

{% block head_other %}{% endblock %}

{% block head_sharing_metadata %}
    {% if request %}
        <meta property="og:image" content="

                {% block meta_sharing_thumbnail %}{% static_absolute 'directory_components/images/opengraph-image.png' %}{% endblock %}">
        <meta property="og:url" content="{{ request.build_absolute_uri }}"/>
    {% endif %}
{% endblock %}

{% block body_header %}
    {% if not request.COOKIES.cookie_preferences_set %}
        <script>
            function acceptAllCookies() {
                const allPreferences = {"essential": true, "settings": true, "usage": true, "campaigns": true};
                document.cookie = "cookie_preferences_set=true; max-age=60*60*24*365";
                document.cookie = "cookies_policy=" + JSON.stringify(allPreferences) + "; max-age=60*60*24*365";
                document.getElementById('atlas-cookie-prompt').remove();
                document.getElementById('atlas-cookie-thanks').style.display = 'block';
            }

            function dismissCookiesThanks() {
                document.getElementById('atlas-cookie-banner').remove();
            }
        </script>
        <div id="atlas-cookie-banner" class="atlas-bg atlas-bg--grey-light">
            <div class="atlas-container atlas-container--header atlas-p-t-xs atlas-regular">
                <div id="atlas-cookie-prompt">
                    <h2 class="atlas-h--s">Tell us whether you accept cookies</h2>
                    <p>We use <a class="atlas-link" href="https://www.great.gov.uk/privacy-and-cookies/">cookies to
                        collect information</a> about how you use great.gov.uk. We use this information to make the
                        website work as well as possible and improve government services.</p>
                    <button class="atlas-button atlas-m-b-xs" onclick="acceptAllCookies()">Accept all</button>
                    <a href="https://www.great.gov.uk/cookies/" class="atlas-button atlas-m-b-xs">Set cookie
                        preferences</a>
                </div>
                <div id="atlas-cookie-thanks" style="display:none;">
                    <p>
                        You've accepted all cookies. You can
                        <a class="atlas-link" href="https://www.great.gov.uk/cookies/">change your settings</a>
                        at any time.
                    </p>
                    <button class="atlas-button atlas-m-b-xs" onclick="dismissCookiesThanks()">Hide this message
                    </button>
                </div>
            </div>
        </div>
    {% endif %}

    {% include 'atlas/components/header.html' with site_section=header_section site_sub_section=header_sub_section %}
{% endblock %}

{% block feedback_reporter %}
    <section dir="ltr" class="error-reporting">
        <div class="container">
            <a id="error-reporting-section-contact-us" href="{{ services_urls.feedback }}"
               target="_blank">{% trans 'Is there anything wrong on this page?' %}</a>
        </div>
    </section>
{% endblock %}

{% block body_footer %}
    {% include 'atlas/components/footer.html' %}
{% endblock %}

{% block body_js %}
    <script>
        function atlasToggleReveal(buttonEl, state) {
            const openState = typeof state !== 'undefined'
                ? state
                : buttonEl.getAttribute('aria-expanded') !== 'true'
            const expandedAttr = openState ? 'true' : 'false'
            const targetEl = document.querySelector('#' + buttonEl.getAttribute('aria-controls'));
            buttonEl.setAttribute('aria-expanded', expandedAttr);
            targetEl.setAttribute('aria-expanded', expandedAttr);
        }

        document.querySelectorAll('[data-reveal-button]').forEach(function (el) {
            atlasToggleReveal(el, false)
            el.addEventListener('click', function (event) {
                atlasToggleReveal(event.target);
            })
        })
    </script>
{% endblock %}
